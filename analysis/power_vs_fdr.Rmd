---
title: "Power vs FDR plots for paper"
author: Yuxin Zou and Peter Carbonetto
output: workflowr::wflow_html
---

Load some packages used to create the power vs. FDR plots:

```{r load-pkgs}
library(ggplot2)
library(cowplot)
```

Load the results from the UK Biobank simulations:

```{r load-results}
res = readRDS("data/roc_data.rds")
```

Create the power vs. FDR plot comparing different fine-mapping methods
when they are provided with the "in sample" LD:

```{r in-sample, fig.height=3, fig.width=3}
colors = c('#A60628', '#7A68A6', '#348ABD', '#467821', '#FF00FF', '#E2A233', 
           '#00FFFF', '#A9A9A9', '#ADFF2F', '#188487',  '#FF0000', '#000000', 
           '#FFD700', '#00FF00', '#9400D3', '#7FFFD4', '#A52A2A', '#000080')
type = 'pr'
main = "Power vs FDR"
ylab = "Power"
xlab = "FDR"
dev.new()
i = 1
labels = vector()
xlim = 0.3
ylim = 0.3
add_text = function(thresholds, x, y, threshold, color, delta = -0.06) {
  idx = which(thresholds == threshold)
  # text(x[idx] - delta, y[idx], labels = threshold, col = color, cex=0.8)
  points(x[idx],y[idx], col=color)
}
for (method in c('susie-suff-refineTRUE',
                 'susie-rss-L10-refineTRUE-LDin',
                 'susie-rss-oracle-refineTRUE-LDin',
                 'FINEMAP-L4-LDin',
                 "FINEMAP-oracle-LDin",
                 'DAP-G-LDin',
                 'CAVIAR-LDin')) {
  x = 1 - tb[[method]][[type]][,1]
  y = tb[[method]][[type]][,2]
  if (i == 1) {
    plot(x, y, t="l", col=colors[i], ylab = ylab, xlab = xlab, main = main,
	     bty='l',lwd = 2, xlim = c(0,xlim), ylim = c(0,ylim))
  } else {
    lines(x, y, col=colors[i], lwd = 2, xlim = c(0,xlim), ylim = c(0,ylim))
  }
  add_text(tb[[method]][[type]][,3], x, y, 0.95, colors[i])
  labels[i] = method
  labels[i] = gsub('-refineTRUE', '', labels[i])
  labels[i] = gsub('-LDin', '', labels[i])
  labels[i] = gsub('susie-suff', 'SuSiE-suff', labels[i])
  labels[i] = gsub('susie-rss', 'SuSiE-RSS', labels[i])
  labels[i] = gsub('-L10', '', labels[i])
  labels[i] = gsub('-L4', '', labels[i])
  labels[i] = gsub('-oracle', ', L = true', labels[i])
  i = i + 1
}
legend("bottomright", legend=labels, col=colors[1:i], lty=1)
```

